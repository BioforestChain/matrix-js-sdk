<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>matrix-js-sdk</title><meta name="description" content="Documentation for matrix-js-sdk"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os"</script><header class="tsd-page-toolbar">
<div class="tsd-toolbar-contents container">
<div class="table-cell" id="tsd-search" data-base=".">
<div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M15.7824 13.833L12.6666 10.7177C12.5259 10.5771 12.3353 10.499 12.1353 10.499H11.6259C12.4884 9.39596 13.001 8.00859 13.001 6.49937C13.001 2.90909 10.0914 0 6.50048 0C2.90959 0 0 2.90909 0 6.49937C0 10.0896 2.90959 12.9987 6.50048 12.9987C8.00996 12.9987 9.39756 12.4863 10.5008 11.6239V12.1332C10.5008 12.3332 10.5789 12.5238 10.7195 12.6644L13.8354 15.7797C14.1292 16.0734 14.6042 16.0734 14.8948 15.7797L15.7793 14.8954C16.0731 14.6017 16.0731 14.1267 15.7824 13.833ZM6.50048 10.499C4.29094 10.499 2.50018 8.71165 2.50018 6.49937C2.50018 4.29021 4.28781 2.49976 6.50048 2.49976C8.71001 2.49976 10.5008 4.28708 10.5008 6.49937C10.5008 8.70852 8.71314 10.499 6.50048 10.499Z" fill="var(--color-text)"></path></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div>
<div class="field">
<div id="tsd-toolbar-links"></div></div>
<ul class="results">
<li class="state loading">Preparing search index...</li>
<li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">matrix-js-sdk</a></div>
<div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="1" y="3" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="7" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="11" width="14" height="2" fill="var(--color-text)"></rect></svg></a></div></div></header>
<div class="container container-main">
<div class="col-8 col-content">
<div class="tsd-page-title">
<h2>matrix-js-sdk</h2></div>
<div class="tsd-panel tsd-typography"><p><a href="https://www.npmjs.com/package/matrix-js-sdk"><img src="https://img.shields.io/npm/v/matrix-js-sdk" alt="npm"></a>
<img src="https://github.com/matrix-org/matrix-js-sdk/actions/workflows/tests.yml/badge.svg" alt="Tests">
<img src="https://github.com/matrix-org/matrix-js-sdk/actions/workflows/static_analysis.yml/badge.svg" alt="Static Analysis">
<a href="https://sonarcloud.io/summary/new_code?id=matrix-js-sdk"><img src="https://sonarcloud.io/api/project_badges/measure?project=matrix-js-sdk&metric=alert_status" alt="Quality Gate Status"></a>
<a href="https://sonarcloud.io/summary/new_code?id=matrix-js-sdk"><img src="https://sonarcloud.io/api/project_badges/measure?project=matrix-js-sdk&metric=coverage" alt="Coverage"></a>
<a href="https://sonarcloud.io/summary/new_code?id=matrix-js-sdk"><img src="https://sonarcloud.io/api/project_badges/measure?project=matrix-js-sdk&metric=vulnerabilities" alt="Vulnerabilities"></a>
<a href="https://sonarcloud.io/summary/new_code?id=matrix-js-sdk"><img src="https://sonarcloud.io/api/project_badges/measure?project=matrix-js-sdk&metric=bugs" alt="Bugs"></a></p>

<a href="#matrix-javascript-sdk" id="matrix-javascript-sdk" style="color: inherit; text-decoration: none;">
  <h1>Matrix Javascript SDK</h1>
</a>
<p>This is the <a href="https://matrix.org">Matrix</a> Client-Server SDK for JavaScript and TypeScript. This SDK can be run in a
browser or in Node.js.</p>
<p>The Matrix specification is constantly evolving - while this SDK aims for maximum backwards compatibility, it only
guarantees that a feature will be supported for at least 4 spec releases. For example, if a feature the js-sdk supports
is removed in v1.4 then the feature is <em>eligible</em> for removal from the SDK when v1.8 is released. This SDK has no
guarantee on implementing all features of any particular spec release, currently. This can mean that the SDK will call
endpoints from before Matrix 1.1, for example.</p>

<a href="#quickstart" id="quickstart" style="color: inherit; text-decoration: none;">
  <h1>Quickstart</h1>
</a>

<a href="#in-a-browser" id="in-a-browser" style="color: inherit; text-decoration: none;">
  <h2>In a browser</h2>
</a>
<p>Download the browser version from
<a href="https://github.com/matrix-org/matrix-js-sdk/releases/latest">https://github.com/matrix-org/matrix-js-sdk/releases/latest</a> and add that as a
<code>&lt;script&gt;</code> to your page. There will be a global variable <code>matrixcs</code>
attached to <code>window</code> through which you can access the SDK. See below for how to
include libolm to enable end-to-end-encryption.</p>
<p>The browser bundle supports recent versions of browsers. Typically this is ES2015
or <code>&gt; 0.5%, last 2 versions, Firefox ESR, not dead</code> if using
<a href="https://github.com/browserslist/browserslist">browserlists</a>.</p>
<p>Please check <a href="examples/browser">the working browser example</a> for more information.</p>

<a href="#in-nodejs" id="in-nodejs" style="color: inherit; text-decoration: none;">
  <h2>In Node.js</h2>
</a>
<p>Ensure you have the latest LTS version of Node.js installed.
This library relies on <code>fetch</code> which is available in Node from v18.0.0 - it should work fine also with polyfills.
If you wish to use a ponyfill or adapter of some sort then pass it as <code>fetchFn</code> to the MatrixClient constructor options.</p>
<p>Using <code>yarn</code> instead of <code>npm</code> is recommended. Please see the Yarn <a href="https://classic.yarnpkg.com/en/docs/install">install guide</a>
if you do not have it already.</p>
<p><code>yarn add matrix-js-sdk</code></p>
<pre><code class="language-javascript"><span class="hl-0">  </span><span class="hl-1">import</span><span class="hl-0"> </span><span class="hl-2">*</span><span class="hl-0"> </span><span class="hl-1">as</span><span class="hl-0"> </span><span class="hl-3">sdk</span><span class="hl-0"> </span><span class="hl-1">from</span><span class="hl-0"> </span><span class="hl-4">&quot;matrix-js-sdk&quot;</span><span class="hl-0">;</span><br/><span class="hl-0">  </span><span class="hl-2">const</span><span class="hl-0"> </span><span class="hl-5">client</span><span class="hl-0"> = </span><span class="hl-3">sdk</span><span class="hl-0">.</span><span class="hl-6">createClient</span><span class="hl-0">(</span><span class="hl-4">&quot;https://matrix.org&quot;</span><span class="hl-0">);</span><br/><span class="hl-0">  </span><span class="hl-3">client</span><span class="hl-0">.</span><span class="hl-6">publicRooms</span><span class="hl-0">(</span><span class="hl-2">function</span><span class="hl-0">(</span><span class="hl-3">err</span><span class="hl-0">, </span><span class="hl-3">data</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-3">console</span><span class="hl-0">.</span><span class="hl-6">log</span><span class="hl-0">(</span><span class="hl-4">&quot;Public Rooms: %s&quot;</span><span class="hl-0">, </span><span class="hl-5">JSON</span><span class="hl-0">.</span><span class="hl-6">stringify</span><span class="hl-0">(</span><span class="hl-3">data</span><span class="hl-0">));</span><br/><span class="hl-0">  });</span>
</code></pre>
<p>See below for how to include libolm to enable end-to-end-encryption. Please check
<a href="examples/node">the Node.js terminal app</a> for a more complex example.</p>
<p>To start the client:</p>
<pre><code class="language-javascript"><span class="hl-1">await</span><span class="hl-0"> </span><span class="hl-3">client</span><span class="hl-0">.</span><span class="hl-6">startClient</span><span class="hl-0">({</span><span class="hl-3">initialSyncLimit:</span><span class="hl-0"> </span><span class="hl-7">10</span><span class="hl-0">});</span>
</code></pre>
<p>You can perform a call to <code>/sync</code> to get the current state of the client:</p>
<pre><code class="language-javascript"><span class="hl-3">client</span><span class="hl-0">.</span><span class="hl-6">once</span><span class="hl-0">(</span><span class="hl-4">&#39;sync&#39;</span><span class="hl-0">, </span><span class="hl-2">function</span><span class="hl-0">(</span><span class="hl-3">state</span><span class="hl-0">, </span><span class="hl-3">prevState</span><span class="hl-0">, </span><span class="hl-3">res</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-1">if</span><span class="hl-0">(</span><span class="hl-3">state</span><span class="hl-0"> === </span><span class="hl-4">&#39;PREPARED&#39;</span><span class="hl-0">) {</span><br/><span class="hl-0">        </span><span class="hl-3">console</span><span class="hl-0">.</span><span class="hl-6">log</span><span class="hl-0">(</span><span class="hl-4">&quot;prepared&quot;</span><span class="hl-0">);</span><br/><span class="hl-0">    } </span><span class="hl-1">else</span><span class="hl-0"> {</span><br/><span class="hl-0">        </span><span class="hl-3">console</span><span class="hl-0">.</span><span class="hl-6">log</span><span class="hl-0">(</span><span class="hl-3">state</span><span class="hl-0">);</span><br/><span class="hl-0">        </span><span class="hl-3">process</span><span class="hl-0">.</span><span class="hl-6">exit</span><span class="hl-0">(</span><span class="hl-7">1</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">});</span>
</code></pre>
<p>To send a message:</p>
<pre><code class="language-javascript"><span class="hl-2">const</span><span class="hl-0"> </span><span class="hl-5">content</span><span class="hl-0"> = {</span><br/><span class="hl-0">    </span><span class="hl-4">&quot;body&quot;</span><span class="hl-3">:</span><span class="hl-0"> </span><span class="hl-4">&quot;message text&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-4">&quot;msgtype&quot;</span><span class="hl-3">:</span><span class="hl-0"> </span><span class="hl-4">&quot;m.text&quot;</span><br/><span class="hl-0">};</span><br/><span class="hl-3">client</span><span class="hl-0">.</span><span class="hl-6">sendEvent</span><span class="hl-0">(</span><span class="hl-4">&quot;roomId&quot;</span><span class="hl-0">, </span><span class="hl-4">&quot;m.room.message&quot;</span><span class="hl-0">, </span><span class="hl-3">content</span><span class="hl-0">, </span><span class="hl-4">&quot;&quot;</span><span class="hl-0">, (</span><span class="hl-3">err</span><span class="hl-0">, </span><span class="hl-3">res</span><span class="hl-0">) </span><span class="hl-2">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-3">console</span><span class="hl-0">.</span><span class="hl-6">log</span><span class="hl-0">(</span><span class="hl-3">err</span><span class="hl-0">);</span><br/><span class="hl-0">});</span>
</code></pre>
<p>To listen for message events:</p>
<pre><code class="language-javascript"><span class="hl-3">client</span><span class="hl-0">.</span><span class="hl-6">on</span><span class="hl-0">(</span><span class="hl-4">&quot;Room.timeline&quot;</span><span class="hl-0">, </span><span class="hl-2">function</span><span class="hl-0">(</span><span class="hl-3">event</span><span class="hl-0">, </span><span class="hl-3">room</span><span class="hl-0">, </span><span class="hl-3">toStartOfTimeline</span><span class="hl-0">) {</span><br/><span class="hl-0">  </span><span class="hl-1">if</span><span class="hl-0"> (</span><span class="hl-3">event</span><span class="hl-0">.</span><span class="hl-6">getType</span><span class="hl-0">() !== </span><span class="hl-4">&quot;m.room.message&quot;</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-1">return</span><span class="hl-0">; </span><span class="hl-8">// only use messages</span><br/><span class="hl-0">  }</span><br/><span class="hl-0">  </span><span class="hl-3">console</span><span class="hl-0">.</span><span class="hl-6">log</span><span class="hl-0">(</span><span class="hl-3">event</span><span class="hl-0">.</span><span class="hl-3">event</span><span class="hl-0">.</span><span class="hl-3">content</span><span class="hl-0">.</span><span class="hl-3">body</span><span class="hl-0">);</span><br/><span class="hl-0">});</span>
</code></pre>
<p>By default, the <code>matrix-js-sdk</code> client uses the <code>MemoryStore</code> to store events as they are received. For example to iterate through the currently stored timeline for a room:</p>
<pre><code class="language-javascript"><span class="hl-3">Object</span><span class="hl-0">.</span><span class="hl-6">keys</span><span class="hl-0">(</span><span class="hl-3">client</span><span class="hl-0">.</span><span class="hl-3">store</span><span class="hl-0">.</span><span class="hl-3">rooms</span><span class="hl-0">).</span><span class="hl-6">forEach</span><span class="hl-0">((</span><span class="hl-3">roomId</span><span class="hl-0">) </span><span class="hl-2">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-3">client</span><span class="hl-0">.</span><span class="hl-6">getRoom</span><span class="hl-0">(</span><span class="hl-3">roomId</span><span class="hl-0">).</span><span class="hl-3">timeline</span><span class="hl-0">.</span><span class="hl-6">forEach</span><span class="hl-0">(</span><span class="hl-3">t</span><span class="hl-0"> </span><span class="hl-2">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">      </span><span class="hl-3">console</span><span class="hl-0">.</span><span class="hl-6">log</span><span class="hl-0">(</span><span class="hl-3">t</span><span class="hl-0">.</span><span class="hl-3">event</span><span class="hl-0">);</span><br/><span class="hl-0">  });</span><br/><span class="hl-0">});</span>
</code></pre>

<a href="#what-does-this-sdk-do" id="what-does-this-sdk-do" style="color: inherit; text-decoration: none;">
  <h2>What does this SDK do?</h2>
</a>
<p>This SDK provides a full object model around the Matrix Client-Server API and emits
events for incoming data and state changes. Aside from wrapping the HTTP API, it:</p>
<ul>
<li>Handles syncing (via <code>/initialSync</code> and <code>/events</code>)</li>
<li>Handles the generation of &quot;friendly&quot; room and member names.</li>
<li>Handles historical <code>RoomMember</code> information (e.g. display names).</li>
<li>Manages room member state across multiple events (e.g. it handles typing, power
levels and membership changes).</li>
<li>Exposes high-level objects like <code>Rooms</code>, <code>RoomState</code>, <code>RoomMembers</code> and <code>Users</code>
which can be listened to for things like name changes, new messages, membership
changes, presence changes, and more.</li>
<li>Handle &quot;local echo&quot; of messages sent using the SDK. This means that messages
that have just been sent will appear in the timeline as &#39;sending&#39;, until it
completes. This is beneficial because it prevents there being a gap between
hitting the send button and having the &quot;remote echo&quot; arrive.</li>
<li>Mark messages which failed to send as not sent.</li>
<li>Automatically retry requests to send messages due to network errors.</li>
<li>Automatically retry requests to send messages due to rate limiting errors.</li>
<li>Handle queueing of messages.</li>
<li>Handles pagination.</li>
<li>Handle assigning push actions for events.</li>
<li>Handles room initial sync on accepting invites.</li>
<li>Handles WebRTC calling.</li>
</ul>
<p>Later versions of the SDK will:</p>
<ul>
<li>Expose a <code>RoomSummary</code> which would be suitable for a recents page.</li>
<li>Provide different pluggable storage layers (e.g. local storage, database-backed)</li>
</ul>

<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
  <h1>Usage</h1>
</a>

<a href="#conventions" id="conventions" style="color: inherit; text-decoration: none;">
  <h2>Conventions</h2>
</a>

<a href="#emitted-events" id="emitted-events" style="color: inherit; text-decoration: none;">
  <h3>Emitted events</h3>
</a>
<p>The SDK will emit events using an <code>EventEmitter</code>. It also
emits object models (e.g. <code>Rooms</code>, <code>RoomMembers</code>) when they
are updated.</p>
<pre><code class="language-javascript"><span class="hl-0">  </span><span class="hl-8">// Listen for low-level MatrixEvents</span><br/><span class="hl-0">  </span><span class="hl-3">client</span><span class="hl-0">.</span><span class="hl-6">on</span><span class="hl-0">(</span><span class="hl-4">&quot;event&quot;</span><span class="hl-0">, </span><span class="hl-2">function</span><span class="hl-0">(</span><span class="hl-3">event</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-3">console</span><span class="hl-0">.</span><span class="hl-6">log</span><span class="hl-0">(</span><span class="hl-3">event</span><span class="hl-0">.</span><span class="hl-6">getType</span><span class="hl-0">());</span><br/><span class="hl-0">  });</span><br/><br/><span class="hl-0">  </span><span class="hl-8">// Listen for typing changes</span><br/><span class="hl-0">  </span><span class="hl-3">client</span><span class="hl-0">.</span><span class="hl-6">on</span><span class="hl-0">(</span><span class="hl-4">&quot;RoomMember.typing&quot;</span><span class="hl-0">, </span><span class="hl-2">function</span><span class="hl-0">(</span><span class="hl-3">event</span><span class="hl-0">, </span><span class="hl-3">member</span><span class="hl-0">) {</span><br/><span class="hl-0">    </span><span class="hl-1">if</span><span class="hl-0"> (</span><span class="hl-3">member</span><span class="hl-0">.</span><span class="hl-3">typing</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-3">console</span><span class="hl-0">.</span><span class="hl-6">log</span><span class="hl-0">(</span><span class="hl-3">member</span><span class="hl-0">.</span><span class="hl-3">name</span><span class="hl-0"> + </span><span class="hl-4">&quot; is typing...&quot;</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">    </span><span class="hl-1">else</span><span class="hl-0"> {</span><br/><span class="hl-0">      </span><span class="hl-3">console</span><span class="hl-0">.</span><span class="hl-6">log</span><span class="hl-0">(</span><span class="hl-3">member</span><span class="hl-0">.</span><span class="hl-3">name</span><span class="hl-0"> + </span><span class="hl-4">&quot; stopped typing.&quot;</span><span class="hl-0">);</span><br/><span class="hl-0">    }</span><br/><span class="hl-0">  });</span><br/><br/><span class="hl-0">  </span><span class="hl-8">// start the client to setup the connection to the server</span><br/><span class="hl-0">  </span><span class="hl-3">client</span><span class="hl-0">.</span><span class="hl-6">startClient</span><span class="hl-0">();</span>
</code></pre>

<a href="#promises-and-callbacks" id="promises-and-callbacks" style="color: inherit; text-decoration: none;">
  <h3>Promises and Callbacks</h3>
</a>
<p>Most of the methods in the SDK are asynchronous: they do not directly return a
result, but instead return a <a href="http://documentup.com/kriskowal/q/">Promise</a>
which will be fulfilled in the future.</p>
<p>The typical usage is something like:</p>
<pre><code class="language-javascript"><span class="hl-0">  </span><span class="hl-3">matrixClient</span><span class="hl-0">.</span><span class="hl-6">someMethod</span><span class="hl-0">(</span><span class="hl-3">arg1</span><span class="hl-0">, </span><span class="hl-3">arg2</span><span class="hl-0">).</span><span class="hl-6">then</span><span class="hl-0">(</span><span class="hl-2">function</span><span class="hl-0">(</span><span class="hl-3">result</span><span class="hl-0">) {</span><br/><span class="hl-0">    ...</span><br/><span class="hl-0">  });</span>
</code></pre>
<p>Alternatively, if you have a Node.js-style <code>callback(err, result)</code> function,
you can pass the result of the promise into it with something like:</p>
<pre><code class="language-javascript"><span class="hl-0">  </span><span class="hl-3">matrixClient</span><span class="hl-0">.</span><span class="hl-6">someMethod</span><span class="hl-0">(</span><span class="hl-3">arg1</span><span class="hl-0">, </span><span class="hl-3">arg2</span><span class="hl-0">).</span><span class="hl-6">nodeify</span><span class="hl-0">(</span><span class="hl-3">callback</span><span class="hl-0">);</span>
</code></pre>
<p>The main thing to note is that it is problematic to discard the result of a
promise-returning function, as that will cause exceptions to go unobserved.</p>
<p>Methods which return a promise show this in their documentation.</p>
<p>Many methods in the SDK support <em>both</em> Node.js-style callbacks <em>and</em> Promises,
via an optional <code>callback</code> argument. The callback support is now deprecated:
new methods do not include a <code>callback</code> argument, and in the future it may be
removed from existing methods.</p>

<a href="#examples" id="examples" style="color: inherit; text-decoration: none;">
  <h2>Examples</h2>
</a>
<p>This section provides some useful code snippets which demonstrate the
core functionality of the SDK. These examples assume the SDK is setup like this:</p>
<pre><code class="language-javascript"><span class="hl-0">   </span><span class="hl-1">import</span><span class="hl-0"> </span><span class="hl-2">*</span><span class="hl-0"> </span><span class="hl-1">as</span><span class="hl-0"> </span><span class="hl-3">sdk</span><span class="hl-0"> </span><span class="hl-1">from</span><span class="hl-0"> </span><span class="hl-4">&quot;matrix-js-sdk&quot;</span><span class="hl-0">;</span><br/><span class="hl-0">   </span><span class="hl-2">const</span><span class="hl-0"> </span><span class="hl-5">myUserId</span><span class="hl-0"> = </span><span class="hl-4">&quot;@example:localhost&quot;</span><span class="hl-0">;</span><br/><span class="hl-0">   </span><span class="hl-2">const</span><span class="hl-0"> </span><span class="hl-5">myAccessToken</span><span class="hl-0"> = </span><span class="hl-4">&quot;QGV4YW1wbGU6bG9jYWxob3N0.qPEvLuYfNBjxikiCjP&quot;</span><span class="hl-0">;</span><br/><span class="hl-0">   </span><span class="hl-2">const</span><span class="hl-0"> </span><span class="hl-5">matrixClient</span><span class="hl-0"> = </span><span class="hl-3">sdk</span><span class="hl-0">.</span><span class="hl-6">createClient</span><span class="hl-0">({</span><br/><span class="hl-0">       </span><span class="hl-3">baseUrl:</span><span class="hl-0"> </span><span class="hl-4">&quot;http://localhost:8008&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">       </span><span class="hl-3">accessToken:</span><span class="hl-0"> </span><span class="hl-3">myAccessToken</span><span class="hl-0">,</span><br/><span class="hl-0">       </span><span class="hl-3">userId:</span><span class="hl-0"> </span><span class="hl-3">myUserId</span><br/><span class="hl-0">   });</span>
</code></pre>

<a href="#automatically-join-rooms-when-invited" id="automatically-join-rooms-when-invited" style="color: inherit; text-decoration: none;">
  <h3>Automatically join rooms when invited</h3>
</a>
<pre><code class="language-javascript"><span class="hl-0">   </span><span class="hl-3">matrixClient</span><span class="hl-0">.</span><span class="hl-6">on</span><span class="hl-0">(</span><span class="hl-4">&quot;RoomMember.membership&quot;</span><span class="hl-0">, </span><span class="hl-2">function</span><span class="hl-0">(</span><span class="hl-3">event</span><span class="hl-0">, </span><span class="hl-3">member</span><span class="hl-0">) {</span><br/><span class="hl-0">       </span><span class="hl-1">if</span><span class="hl-0"> (</span><span class="hl-3">member</span><span class="hl-0">.</span><span class="hl-3">membership</span><span class="hl-0"> === </span><span class="hl-4">&quot;invite&quot;</span><span class="hl-0"> &amp;&amp; </span><span class="hl-3">member</span><span class="hl-0">.</span><span class="hl-3">userId</span><span class="hl-0"> === </span><span class="hl-3">myUserId</span><span class="hl-0">) {</span><br/><span class="hl-0">           </span><span class="hl-3">matrixClient</span><span class="hl-0">.</span><span class="hl-6">joinRoom</span><span class="hl-0">(</span><span class="hl-3">member</span><span class="hl-0">.</span><span class="hl-3">roomId</span><span class="hl-0">).</span><span class="hl-6">then</span><span class="hl-0">(</span><span class="hl-2">function</span><span class="hl-0">() {</span><br/><span class="hl-0">               </span><span class="hl-3">console</span><span class="hl-0">.</span><span class="hl-6">log</span><span class="hl-0">(</span><span class="hl-4">&quot;Auto-joined %s&quot;</span><span class="hl-0">, </span><span class="hl-3">member</span><span class="hl-0">.</span><span class="hl-3">roomId</span><span class="hl-0">);</span><br/><span class="hl-0">           });</span><br/><span class="hl-0">       }</span><br/><span class="hl-0">   });</span><br/><br/><span class="hl-0">   </span><span class="hl-3">matrixClient</span><span class="hl-0">.</span><span class="hl-6">startClient</span><span class="hl-0">();</span>
</code></pre>

<a href="#print-out-messages-for-all-rooms" id="print-out-messages-for-all-rooms" style="color: inherit; text-decoration: none;">
  <h3>Print out messages for all rooms</h3>
</a>
<pre><code class="language-javascript"><span class="hl-0">   </span><span class="hl-3">matrixClient</span><span class="hl-0">.</span><span class="hl-6">on</span><span class="hl-0">(</span><span class="hl-4">&quot;Room.timeline&quot;</span><span class="hl-0">, </span><span class="hl-2">function</span><span class="hl-0">(</span><span class="hl-3">event</span><span class="hl-0">, </span><span class="hl-3">room</span><span class="hl-0">, </span><span class="hl-3">toStartOfTimeline</span><span class="hl-0">) {</span><br/><span class="hl-0">       </span><span class="hl-1">if</span><span class="hl-0"> (</span><span class="hl-3">toStartOfTimeline</span><span class="hl-0">) {</span><br/><span class="hl-0">           </span><span class="hl-1">return</span><span class="hl-0">; </span><span class="hl-8">// don&#39;t print paginated results</span><br/><span class="hl-0">       }</span><br/><span class="hl-0">       </span><span class="hl-1">if</span><span class="hl-0"> (</span><span class="hl-3">event</span><span class="hl-0">.</span><span class="hl-6">getType</span><span class="hl-0">() !== </span><span class="hl-4">&quot;m.room.message&quot;</span><span class="hl-0">) {</span><br/><span class="hl-0">           </span><span class="hl-1">return</span><span class="hl-0">; </span><span class="hl-8">// only print messages</span><br/><span class="hl-0">       }</span><br/><span class="hl-0">       </span><span class="hl-3">console</span><span class="hl-0">.</span><span class="hl-6">log</span><span class="hl-0">(</span><br/><span class="hl-0">           </span><span class="hl-8">// the room name will update with m.room.name events automatically</span><br/><span class="hl-0">           </span><span class="hl-4">&quot;(%s) %s :: %s&quot;</span><span class="hl-0">, </span><span class="hl-3">room</span><span class="hl-0">.</span><span class="hl-3">name</span><span class="hl-0">, </span><span class="hl-3">event</span><span class="hl-0">.</span><span class="hl-6">getSender</span><span class="hl-0">(), </span><span class="hl-3">event</span><span class="hl-0">.</span><span class="hl-6">getContent</span><span class="hl-0">().</span><span class="hl-3">body</span><br/><span class="hl-0">       );</span><br/><span class="hl-0">   });</span><br/><br/><span class="hl-0">   </span><span class="hl-3">matrixClient</span><span class="hl-0">.</span><span class="hl-6">startClient</span><span class="hl-0">();</span>
</code></pre>
<p>Output:</p>
<pre><code><span class="hl-0">  (</span><span class="hl-3">My</span><span class="hl-0"> </span><span class="hl-3">Room</span><span class="hl-0">) @</span><span class="hl-3">megan</span><span class="hl-0">:</span><span class="hl-3">localhost</span><span class="hl-0"> :: </span><span class="hl-3">Hello</span><span class="hl-0"> </span><span class="hl-3">world</span><br/><span class="hl-0">  (</span><span class="hl-3">My</span><span class="hl-0"> </span><span class="hl-3">Room</span><span class="hl-0">) @</span><span class="hl-3">megan</span><span class="hl-0">:</span><span class="hl-3">localhost</span><span class="hl-0"> :: </span><span class="hl-3">how</span><span class="hl-0"> </span><span class="hl-3">are</span><span class="hl-0"> </span><span class="hl-3">you</span><span class="hl-0">?</span><br/><span class="hl-0">  (</span><span class="hl-3">My</span><span class="hl-0"> </span><span class="hl-3">Room</span><span class="hl-0">) @</span><span class="hl-3">example</span><span class="hl-0">:</span><span class="hl-9">localhost</span><span class="hl-0"> :: </span><span class="hl-5">I</span><span class="hl-0"> </span><span class="hl-3">am</span><span class="hl-0"> </span><span class="hl-3">good</span><br/><span class="hl-0">  (</span><span class="hl-3">My</span><span class="hl-0"> </span><span class="hl-3">Room</span><span class="hl-0">) @</span><span class="hl-3">example</span><span class="hl-0">:</span><span class="hl-3">localhost</span><span class="hl-0"> :: </span><span class="hl-3">change</span><span class="hl-0"> </span><span class="hl-3">the</span><span class="hl-0"> </span><span class="hl-3">room</span><span class="hl-0"> </span><span class="hl-3">name</span><br/><span class="hl-0">  (</span><span class="hl-3">My</span><span class="hl-0"> </span><span class="hl-3">New</span><span class="hl-0"> </span><span class="hl-3">Room</span><span class="hl-0">) @</span><span class="hl-3">megan</span><span class="hl-0">:</span><span class="hl-3">localhost</span><span class="hl-0"> :: </span><span class="hl-3">done</span>
</code></pre>

<a href="#print-out-membership-lists-whenever-they-are-changed" id="print-out-membership-lists-whenever-they-are-changed" style="color: inherit; text-decoration: none;">
  <h3>Print out membership lists whenever they are changed</h3>
</a>
<pre><code class="language-javascript"><span class="hl-0">   </span><span class="hl-3">matrixClient</span><span class="hl-0">.</span><span class="hl-6">on</span><span class="hl-0">(</span><span class="hl-4">&quot;RoomState.members&quot;</span><span class="hl-0">, </span><span class="hl-2">function</span><span class="hl-0">(</span><span class="hl-3">event</span><span class="hl-0">, </span><span class="hl-3">state</span><span class="hl-0">, </span><span class="hl-3">member</span><span class="hl-0">) {</span><br/><span class="hl-0">       </span><span class="hl-2">const</span><span class="hl-0"> </span><span class="hl-5">room</span><span class="hl-0"> = </span><span class="hl-3">matrixClient</span><span class="hl-0">.</span><span class="hl-6">getRoom</span><span class="hl-0">(</span><span class="hl-3">state</span><span class="hl-0">.</span><span class="hl-3">roomId</span><span class="hl-0">);</span><br/><span class="hl-0">       </span><span class="hl-1">if</span><span class="hl-0"> (!</span><span class="hl-3">room</span><span class="hl-0">) {</span><br/><span class="hl-0">           </span><span class="hl-1">return</span><span class="hl-0">;</span><br/><span class="hl-0">       }</span><br/><span class="hl-0">       </span><span class="hl-2">const</span><span class="hl-0"> </span><span class="hl-5">memberList</span><span class="hl-0"> = </span><span class="hl-3">state</span><span class="hl-0">.</span><span class="hl-6">getMembers</span><span class="hl-0">();</span><br/><span class="hl-0">       </span><span class="hl-3">console</span><span class="hl-0">.</span><span class="hl-6">log</span><span class="hl-0">(</span><span class="hl-3">room</span><span class="hl-0">.</span><span class="hl-3">name</span><span class="hl-0">);</span><br/><span class="hl-0">       </span><span class="hl-3">console</span><span class="hl-0">.</span><span class="hl-6">log</span><span class="hl-0">(</span><span class="hl-6">Array</span><span class="hl-0">(</span><span class="hl-3">room</span><span class="hl-0">.</span><span class="hl-3">name</span><span class="hl-0">.</span><span class="hl-3">length</span><span class="hl-0"> + </span><span class="hl-7">1</span><span class="hl-0">).</span><span class="hl-6">join</span><span class="hl-0">(</span><span class="hl-4">&quot;=&quot;</span><span class="hl-0">));  </span><span class="hl-8">// underline</span><br/><span class="hl-0">       </span><span class="hl-1">for</span><span class="hl-0"> (</span><span class="hl-2">var</span><span class="hl-0"> </span><span class="hl-3">i</span><span class="hl-0"> = </span><span class="hl-7">0</span><span class="hl-0">; </span><span class="hl-3">i</span><span class="hl-0"> &lt; </span><span class="hl-3">memberList</span><span class="hl-0">.</span><span class="hl-3">length</span><span class="hl-0">; </span><span class="hl-3">i</span><span class="hl-0">++) {</span><br/><span class="hl-0">           </span><span class="hl-3">console</span><span class="hl-0">.</span><span class="hl-6">log</span><span class="hl-0">(</span><br/><span class="hl-0">               </span><span class="hl-4">&quot;(%s) %s&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">               </span><span class="hl-3">memberList</span><span class="hl-0">[</span><span class="hl-3">i</span><span class="hl-0">].</span><span class="hl-3">membership</span><span class="hl-0">,</span><br/><span class="hl-0">               </span><span class="hl-3">memberList</span><span class="hl-0">[</span><span class="hl-3">i</span><span class="hl-0">].</span><span class="hl-3">name</span><br/><span class="hl-0">           );</span><br/><span class="hl-0">       }</span><br/><span class="hl-0">   });</span><br/><br/><span class="hl-0">   </span><span class="hl-3">matrixClient</span><span class="hl-0">.</span><span class="hl-6">startClient</span><span class="hl-0">();</span>
</code></pre>
<p>Output:</p>
<pre><code><span class="hl-0">  </span><span class="hl-3">My</span><span class="hl-0"> </span><span class="hl-3">Room</span><br/><span class="hl-0">  =======</span><br/><span class="hl-0">  (</span><span class="hl-3">join</span><span class="hl-0">) @</span><span class="hl-3">example</span><span class="hl-0">:</span><span class="hl-3">localhost</span><br/><span class="hl-0">  (</span><span class="hl-3">leave</span><span class="hl-0">) @</span><span class="hl-3">alice</span><span class="hl-0">:</span><span class="hl-3">localhost</span><br/><span class="hl-0">  (</span><span class="hl-3">join</span><span class="hl-0">) </span><span class="hl-3">Bob</span><br/><span class="hl-0">  (</span><span class="hl-3">invite</span><span class="hl-0">) @</span><span class="hl-3">charlie</span><span class="hl-0">:</span><span class="hl-3">localhost</span>
</code></pre>

<a href="#api-reference" id="api-reference" style="color: inherit; text-decoration: none;">
  <h1>API Reference</h1>
</a>
<p>A hosted reference can be found at
<a href="http://matrix-org.github.io/matrix-js-sdk/index.html">http://matrix-org.github.io/matrix-js-sdk/index.html</a></p>
<p>This SDK uses <a href="https://typedoc.org/guides/doccomments">Typedoc</a> doc comments. You can manually build and
host the API reference from the source files like this:</p>
<pre><code><span class="hl-0">  </span><span class="hl-3">$</span><span class="hl-0"> </span><span class="hl-3">yarn</span><span class="hl-0"> </span><span class="hl-3">gendoc</span><br/><span class="hl-0">  </span><span class="hl-3">$</span><span class="hl-0"> </span><span class="hl-3">cd</span><span class="hl-0"> </span><span class="hl-3">_docs</span><br/><span class="hl-0">  </span><span class="hl-3">$</span><span class="hl-0"> </span><span class="hl-3">python</span><span class="hl-0"> -</span><span class="hl-3">m</span><span class="hl-0"> </span><span class="hl-3">http</span><span class="hl-0">.</span><span class="hl-3">server</span><span class="hl-0"> </span><span class="hl-7">8005</span>
</code></pre>
<p>Then visit <code>http://localhost:8005</code> to see the API docs.</p>

<a href="#end-to-end-encryption-support" id="end-to-end-encryption-support" style="color: inherit; text-decoration: none;">
  <h1>End-to-end encryption support</h1>
</a>
<p>The SDK supports end-to-end encryption via the Olm and Megolm protocols, using
<a href="https://gitlab.matrix.org/matrix-org/olm">libolm</a>. It is left up to the
application to make libolm available, via the <code>Olm</code> global.</p>
<p>It is also necessary to call <code>await matrixClient.initCrypto()</code> after creating a new
<code>MatrixClient</code> (but <strong>before</strong> calling <code>matrixClient.startClient()</code>) to
initialise the crypto layer.</p>
<p>If the <code>Olm</code> global is not available, the SDK will show a warning, as shown
below; <code>initCrypto()</code> will also fail.</p>
<pre><code><span class="hl-3">Unable</span><span class="hl-0"> </span><span class="hl-3">to</span><span class="hl-0"> </span><span class="hl-3">load</span><span class="hl-0"> </span><span class="hl-3">crypto</span><span class="hl-0"> </span><span class="hl-9">module</span><span class="hl-0">: </span><span class="hl-3">crypto</span><span class="hl-0"> </span><span class="hl-3">will</span><span class="hl-0"> </span><span class="hl-3">be</span><span class="hl-0"> </span><span class="hl-9">disabled</span><span class="hl-0">: </span><span class="hl-9">Error</span><span class="hl-0">: </span><span class="hl-3">global</span><span class="hl-0">.</span><span class="hl-3">Olm</span><span class="hl-0"> </span><span class="hl-3">is</span><span class="hl-0"> </span><span class="hl-3">not</span><span class="hl-0"> </span><span class="hl-3">defined</span>
</code></pre>
<p>If the crypto layer is not (successfully) initialised, the SDK will continue to
work for unencrypted rooms, but it will not support the E2E parts of the Matrix
specification.</p>
<p>To provide the Olm library in a browser application:</p>
<ul>
<li>download the transpiled libolm (from <a href="https://packages.matrix.org/npm/olm/">https://packages.matrix.org/npm/olm/</a>).</li>
<li>load <code>olm.js</code> as a <code>&lt;script&gt;</code> <em>before</em> <code>browser-matrix.js</code>.</li>
</ul>
<p>To provide the Olm library in a node.js application:</p>
<ul>
<li><code>yarn add https://packages.matrix.org/npm/olm/olm-3.1.4.tgz</code>
(replace the URL with the latest version you want to use from
 <a href="https://packages.matrix.org/npm/olm/">https://packages.matrix.org/npm/olm/</a>)</li>
<li><code>global.Olm = require(&#39;olm&#39;);</code> <em>before</em> loading <code>matrix-js-sdk</code>.</li>
</ul>
<p>If you want to package Olm as dependency for your node.js application, you can
use <code>yarn add https://packages.matrix.org/npm/olm/olm-3.1.4.tgz</code>. If your
application also works without e2e crypto enabled, add <code>--optional</code> to mark it
as an optional dependency.</p>

<a href="#contributing" id="contributing" style="color: inherit; text-decoration: none;">
  <h1>Contributing</h1>
</a>
<p><em>This section is for people who want to modify the SDK. If you just
want to use this SDK, skip this section.</em></p>
<p>First, you need to pull in the right build tools:</p>
<pre><code><span class="hl-0"> </span><span class="hl-3">$</span><span class="hl-0"> </span><span class="hl-3">yarn</span><span class="hl-0"> </span><span class="hl-3">install</span>
</code></pre>

<a href="#building" id="building" style="color: inherit; text-decoration: none;">
  <h2>Building</h2>
</a>
<p>To build a browser version from scratch when developing::</p>
<pre><code><span class="hl-0"> </span><span class="hl-3">$</span><span class="hl-0"> </span><span class="hl-3">yarn</span><span class="hl-0"> </span><span class="hl-3">build</span>
</code></pre>
<p>To run tests (Jasmine)::</p>
<pre><code><span class="hl-0"> </span><span class="hl-3">$</span><span class="hl-0"> </span><span class="hl-3">yarn</span><span class="hl-0"> </span><span class="hl-3">test</span>
</code></pre>
<p>To run linting:</p>
<pre><code><span class="hl-0"> </span><span class="hl-3">$</span><span class="hl-0"> </span><span class="hl-3">yarn</span><span class="hl-0"> </span><span class="hl-3">lint</span>
</code></pre>
</div></div>
<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
<div class="tsd-navigation settings">
<details class="tsd-index-accordion"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Settings</h3></summary>
<div class="tsd-accordion-details">
<div class="tsd-filter-visibility">
<h4 class="uppercase">Member Visibility</h4><form>
<ul id="tsd-filter-options">
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li></ul></form></div>
<div class="tsd-theme-toggle">
<h4 class="uppercase">Theme</h4><select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div>
<nav class="tsd-navigation primary">
<details class="tsd-index-accordion" open><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Modules</h3></summary>
<div class="tsd-accordion-details">
<ul>
<li class="current selected"><a href="modules.html">matrix-<wbr/>js-<wbr/>sdk</a>
<ul>
<li class="tsd-kind-module"><a href="modules/_internal_.html">&lt;internal&gt;</a></li>
<li class="tsd-kind-namespace"><a href="modules/ContentHelpers.html">Content<wbr/>Helpers</a></li>
<li class="tsd-kind-namespace"><a href="modules/default.html">default</a></li></ul></li></ul></div></details></nav></div></div>
<div class="container tsd-generator">
<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div>
<div class="overlay"></div><script src="assets/main.js"></script></body></html>