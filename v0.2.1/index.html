<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Home</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Home</h1>

    



    


    <h3>matrix-js-sdk 0.2.1</h3>










    




    <section>
        <article><h1>Matrix Javascript SDK</h1><p><a href="http://matrix.org/jenkins/job/JavascriptSDK/"><img src="http://matrix.org/jenkins/buildStatus/icon?job=JavascriptSDK" alt="Build Status"></a></p>
<p>This is the <a href="https://matrix.org">Matrix</a> Client-Server v1/v2 alpha SDK for
JavaScript. This SDK can be run in a browser or in Node.js.</p>
<h1>Quickstart</h1><h2>In a browser</h2><p>Copy <code>dist/$VERSION/browser-matrix-$VERSION.js</code> and add that as a <code>&lt;script&gt;</code> to
your page. There will be a global variable <code>matrixcs</code> attached to
<code>window</code> through which you can access the SDK.</p>
<p>Please check <a href="examples/browser">the working browser example</a> for more information. </p>
<h2>In Node.js</h2><p><code>npm install matrix-js-sdk</code></p>
<pre class="prettyprint source lang-javascript"><code>  var sdk = require(&quot;matrix-js-sdk&quot;);
  var client = sdk.createClient(&quot;https://matrix.org&quot;);
  client.publicRooms(function(err, data) {
    console.log(&quot;Public Rooms: %s&quot;, JSON.stringify(data));
  });</code></pre><p>Please check <a href="examples/node">the Node.js terminal app</a> for a more complex example.</p>
<h2>What does this SDK do?</h2><p>This SDK provides a full object model around the Matrix Client-Server API and emits
events for incoming data and state changes. Aside from wrapping the HTTP API, it:</p>
<ul>
<li>Handles syncing (via <code>/initialSync</code> and <code>/events</code>)</li>
<li>Handles the generation of &quot;friendly&quot; room and member names.</li>
<li>Handles historical <code>RoomMember</code> information (e.g. display names).</li>
<li>Manages room member state across multiple events (e.g. it handles typing, power
levels and membership changes).</li>
<li>Exposes high-level objects like <code>Rooms</code>, <code>RoomState</code>, <code>RoomMembers</code> and <code>Users</code>
which can be listened to for things like name changes, new messages, membership
changes, presence changes, and more.</li>
<li>Handle &quot;local echo&quot; of messages sent using the SDK. This means that messages
that have just been sent will appear in the timeline as 'sending', until it
completes. This is beneficial because it prevents there being a gap between
hitting the send button and having the &quot;remote echo&quot; arrive.</li>
<li>Mark messages which failed to send as not sent.</li>
<li>Automatically retry requests to send messages due to network errors.</li>
<li>Automatically retry requests to send messages due to rate limiting errors.</li>
<li>Handle queueing of messages.</li>
<li>Handles pagination.</li>
<li>Handle assigning push actions for events.</li>
<li>Handles room initial sync on accepting invites.</li>
<li>Handles WebRTC calling.</li>
</ul>
<p>Later versions of the SDK will:</p>
<ul>
<li>Expose a <code>RoomSummary</code> which would be suitable for a recents page.</li>
<li>Provide different pluggable storage layers (e.g. local storage, database-backed)</li>
</ul>
<h1>Usage</h1><h2>Conventions</h2><h3>Emitted events</h3><p>The SDK will emit events using an <code>EventEmitter</code>. It also
emits object models (e.g. <code>Rooms</code>, <code>RoomMembers</code>) when they
are updated.</p>
<pre class="prettyprint source lang-javascript"><code>  // Listen for low-level MatrixEvents
  client.on(&quot;event&quot;, function(event) {
    console.log(event.getType());
  });

  // Listen for typing changes
  client.on(&quot;RoomMember.typing&quot;, function(event, member) {
    if (member.typing) {
      console.log(member.name + &quot; is typing...&quot;);
    }
    else {
      console.log(member.name + &quot; stopped typing.&quot;);
    }
  });

  // start the client to setup the connection to the server
  client.startClient();</code></pre><h3>Promises or Callbacks</h3><p>The SDK supports <em>both</em> callbacks and Promises (Q). The convention
you'll see used is:</p>
<pre class="prettyprint source lang-javascript"><code>  var promise = matrixClient.someMethod(arg1, arg2, callback);</code></pre><p>The <code>callback</code> parameter is optional, so you could do:</p>
<pre class="prettyprint source lang-javascript"><code>  matrixClient.someMethod(arg1, arg2).then(function(result) {
    ...
  });</code></pre><p>Alternatively, you could do:</p>
<pre class="prettyprint source lang-javascript"><code>  matrixClient.someMethod(arg1, arg2, function(result) {
    ...
  });</code></pre><p>Methods which support this will be clearly marked as returning
<code>Promises</code>.</p>
<h2>Examples</h2><p>This section provides some useful code snippets which demonstrate the
core functionality of the SDK. These examples assume the SDK is setup like this:</p>
<pre class="prettyprint source lang-javascript"><code>   var sdk = require(&quot;matrix-js-sdk&quot;);
   var myUserId = &quot;@example:localhost&quot;;
   var myAccessToken = &quot;QGV4YW1wbGU6bG9jYWxob3N0.qPEvLuYfNBjxikiCjP&quot;;
   var matrixClient = sdk.createClient({
       baseUrl: &quot;http://localhost:8008&quot;,
       accessToken: myAccessToken,
       userId: myUserId
   });</code></pre><h3>Automatically join rooms when invited</h3><pre class="prettyprint source lang-javascript"><code>   matrixClient.on(&quot;RoomMember.membership&quot;, function(event, member) {
       if (member.membership === &quot;invite&quot; && member.userId === myUserId) {
           matrixClient.joinRoom(member.roomId).done(function() {
               console.log(&quot;Auto-joined %s&quot;, member.roomId);
           });
       }
   });

   matrixClient.startClient();</code></pre><h3>Print out messages for all rooms</h3><pre class="prettyprint source lang-javascript"><code>   matrixClient.on(&quot;Room.timeline&quot;, function(event, room, toStartOfTimeline) {
       if (toStartOfTimeline) {
           return; // don't print paginated results
       }
       if (event.getType() !== &quot;m.room.message&quot;) {
           return; // only print messages
       }
       console.log(
           // the room name will update with m.room.name events automatically
           &quot;(%s) %s :: %s&quot;, room.name, event.getSender(), event.getContent().body
       );
   });

   matrixClient.startClient();</code></pre><p>Output:</p>
<pre class="prettyprint source"><code>  (My Room) @megan:localhost :: Hello world
  (My Room) @megan:localhost :: how are you?
  (My Room) @example:localhost :: I am good
  (My Room) @example:localhost :: change the room name
  (My New Room) @megan:localhost :: done</code></pre><h3>Print out membership lists whenever they are changed</h3><pre class="prettyprint source lang-javascript"><code>   matrixClient.on(&quot;RoomState.members&quot;, function(event, state, member) {
       var room = matrixClient.getRoom(state.roomId);
       if (!room) {
           return;
       }
       var memberList = state.getMembers();
       console.log(room.name);
       console.log(Array(room.name.length + 1).join(&quot;=&quot;));  // underline
       for (var i = 0; i &lt; memberList.length; i++) {
           console.log(
               &quot;(%s) %s&quot;,
               memberList[i].membership,
               memberList[i].name
           );
       }
   });

   matrixClient.startClient();</code></pre><p>Output:</p>
<pre class="prettyprint source"><code>  My Room
  =======
  (join) @example:localhost
  (leave) @alice:localhost
  (join) Bob
  (invite) @charlie:localhost</code></pre><h1>API Reference</h1><p>A hosted reference can be found at
http://matrix-org.github.io/matrix-js-sdk/global.html</p>
<p>This SDK uses JSDoc3 style comments. You can manually build and
host the API reference from the source files like this:</p>
<pre class="prettyprint source"><code>  $ npm install -g jsdoc
  $ jsdoc -r lib/
  $ cd out
  $ python -m SimpleHTTPServer 8005</code></pre><p>Then visit <code>http://localhost:8005</code> to see the API docs. By
default, <code>jsdoc</code> produces HTML in the <code>out</code> folder.</p>
<h1>Contributing</h1><p><em>This section is for people who want to modify the SDK. If you just
want to use this SDK, skip this section.</em></p>
<p>First, you need to pull in the right build tools:</p>
<pre class="prettyprint source"><code> $ npm install</code></pre><h2>Building</h2><p>To build a browser version from scratch when developing::</p>
<pre class="prettyprint source"><code> $ npm run build</code></pre><p>To constantly do builds when files are modified (using <code>watchify</code>)::</p>
<pre class="prettyprint source"><code> $ npm run watch</code></pre><p>To run tests (Jasmine)::</p>
<pre class="prettyprint source"><code> $ npm test</code></pre><p>To run linters (Google Closure Linter and JSHint):</p>
<pre class="prettyprint source"><code> $ npm run lint</code></pre></article>
    </section>






</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-client.html">client</a></li><li><a href="module-http-api.html">http-api</a></li><li><a href="module-models_event.html">models/event</a></li><li><a href="module-models_room.html">models/room</a></li><li><a href="module-models_room-member.html">models/room-member</a></li><li><a href="module-models_room-state.html">models/room-state</a></li><li><a href="module-models_room-summary.html">models/room-summary</a></li><li><a href="module-models_user.html">models/user</a></li><li><a href="module-pushprocessor.html">pushprocessor</a></li><li><a href="module-scheduler.html">scheduler</a></li><li><a href="module-store_memory.html">store/memory</a></li><li><a href="module-store_session_webstorage.html">store/session/webstorage</a></li><li><a href="module-store_stub.html">store/stub</a></li><li><a href="module-store_webstorage.html">store/webstorage</a></li><li><a href="module-utils.html">utils</a></li><li><a href="module-webrtc_call.html">webrtc/call</a></li></ul><h3>Externals</h3><ul><li><a href="external-EventEmitter.html">EventEmitter</a></li></ul><h3>Classes</h3><ul><li><a href="module-client-MatrixClient.html">MatrixClient</a></li><li><a href="module-http-api.MatrixError.html">MatrixError</a></li><li><a href="module-http-api.MatrixHttpApi.html">MatrixHttpApi</a></li><li><a href="module-models_event.MatrixEvent.html">MatrixEvent</a></li><li><a href="module-models_room-member-RoomMember.html">RoomMember</a></li><li><a href="module-models_room-state-RoomState.html">RoomState</a></li><li><a href="module-models_room-summary-RoomSummary.html">RoomSummary</a></li><li><a href="module-models_room-Room.html">Room</a></li><li><a href="module-models_user-User.html">User</a></li><li><a href="module-pushprocessor-PushProcessor.html">PushProcessor</a></li><li><a href="module-scheduler-MatrixScheduler.html">MatrixScheduler</a></li><li><a href="module-store_memory.MatrixInMemoryStore.html">MatrixInMemoryStore</a></li><li><a href="module-store_session_webstorage-WebStorageSessionStore.html">WebStorageSessionStore</a></li><li><a href="module-store_stub-StubStore.html">StubStore</a></li><li><a href="module-store_webstorage-WebStorageStore.html">WebStorageStore</a></li><li><a href="module-webrtc_call-MatrixCall.html">MatrixCall</a></li></ul><h3>Events</h3><ul><li><a href="module-client-MatrixClient.html#event:%2522Call.incoming%2522">"Call.incoming"</a></li><li><a href="module-client-MatrixClient.html#event:%2522event%2522">"event"</a></li><li><a href="module-client-MatrixClient.html#event:%2522Room.name%2522">"Room.name"</a></li><li><a href="module-client-MatrixClient.html#event:%2522Room.timeline%2522">"Room.timeline"</a></li><li><a href="module-client-MatrixClient.html#event:%2522Room%2522">"Room"</a></li><li><a href="module-client-MatrixClient.html#event:%2522RoomMember.membership%2522">"RoomMember.membership"</a></li><li><a href="module-client-MatrixClient.html#event:%2522RoomMember.name%2522">"RoomMember.name"</a></li><li><a href="module-client-MatrixClient.html#event:%2522RoomMember.powerLevel%2522">"RoomMember.powerLevel"</a></li><li><a href="module-client-MatrixClient.html#event:%2522RoomMember.typing%2522">"RoomMember.typing"</a></li><li><a href="module-client-MatrixClient.html#event:%2522RoomState.events%2522">"RoomState.events"</a></li><li><a href="module-client-MatrixClient.html#event:%2522RoomState.members%2522">"RoomState.members"</a></li><li><a href="module-client-MatrixClient.html#event:%2522RoomState.newMember%2522">"RoomState.newMember"</a></li><li><a href="module-client-MatrixClient.html#event:%2522syncComplete%2522">"syncComplete"</a></li><li><a href="module-client-MatrixClient.html#event:%2522syncError%2522">"syncError"</a></li><li><a href="module-client-MatrixClient.html#event:%2522User.avatarUrl%2522">"User.avatarUrl"</a></li><li><a href="module-client-MatrixClient.html#event:%2522User.displayName%2522">"User.displayName"</a></li><li><a href="module-client-MatrixClient.html#event:%2522User.presence%2522">"User.presence"</a></li></ul><h3>Global</h3><ul><li><a href="global.html#createClient">createClient</a></li><li><a href="global.html#createNewMatrixCall">createNewMatrixCall</a></li><li><a href="global.html#CRYPTO_ENABLED">CRYPTO_ENABLED</a></li><li><a href="global.html#EventStatus">EventStatus</a></li><li><a href="global.html#MatrixClient">MatrixClient</a></li><li><a href="global.html#MatrixError">MatrixError</a></li><li><a href="global.html#MatrixEvent">MatrixEvent</a></li><li><a href="global.html#MatrixHttpApi">MatrixHttpApi</a></li><li><a href="global.html#MatrixInMemoryStore">MatrixInMemoryStore</a></li><li><a href="global.html#MatrixScheduler">MatrixScheduler</a></li><li><a href="global.html#request">request</a></li><li><a href="global.html#Room">Room</a></li><li><a href="global.html#RoomMember">RoomMember</a></li><li><a href="global.html#RoomState">RoomState</a></li><li><a href="global.html#User">User</a></li><li><a href="global.html#WebStorageSessionStore">WebStorageSessionStore</a></li><li><a href="global.html#WebStorageStore">WebStorageStore</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.2</a> on Fri Sep 11 2015 10:25:09 GMT+0100 (BST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>